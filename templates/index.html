<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tip Tracker helps restaurant servers log tips, analyze shifts, and boost earnings with free, secure tracking.">
    <meta name="keywords" content="tip tracker, server tips, restaurant income, gratuity app, waitress tips, track earnings">
    <meta name="robots" content="index, follow">
    <meta name="google-site-verification" content="GOOGLE_VERIFICATION_TOKEN">
    <meta name="facebook-domain-verification" content="FACEBOOK_VERIFICATION_TOKEN">
    <link rel="canonical" href="{{ url_for('index', _external=True) }}">
    <title>Tip Tracker | Free Tip Tracking for Restaurant Servers</title>

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Tip Tracker | Free Tip Tracking for Restaurant Servers">
    <meta property="og:description" content="Log cash and card tips, view daily stats, and maximize your income.">
    <meta property="og:url" content="{{ url_for('index', _external=True) }}">
    <meta property="og:image" content="{{ url_for('static', filename='img/og-image.png', _external=True) }}">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Tip Tracker | Free Tip Tracking for Restaurant Servers">
    <meta name="twitter:description" content="Track tips with confidence and discover earning trends.">
    <meta name="twitter:image" content="{{ url_for('static', filename='img/og-image.png', _external=True) }}">
    <meta name="theme-color" content="#0d6efd">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Tip Tracker",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Web",
      "description": "Tip Tracker helps restaurant servers monitor earnings, spot trends, and make every shift count.",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-dollar-sign me-2"></i>
                Tip Tracker
            </a>
            
            <div class="navbar-nav ms-auto">
                <div class="nav-item" id="authSection">
                    <button class="btn btn-primary" id="loginBtn" onclick="signInWithGoogle()">
                        <i class="fab fa-google me-2"></i>
                        Sign in with Google
                    </button>
                    
                    <div id="userSection" class="d-none">
                        <span class="navbar-text me-3">
                            Welcome, <span id="userName"></span>
                            <span id="userRole" class="badge bg-secondary ms-2"></span>
                        </span>
                        <button class="btn btn-outline-secondary btn-sm" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Alert area -->
        <div id="alertArea"></div>
        
        <!-- Landing Page for Unauthenticated Users -->
        <div id="authRequired" class="py-5">
            <div class="text-center hero mb-5">
                <h1 class="display-5 fw-bold mb-3">Track Restaurant Tips &amp; Boost Your Income</h1>
                <p class="lead text-muted mb-4">Free tip tracking app for servers&mdash;log cash and card tips, analyze shifts, and reach your goals faster.</p>
                <button class="btn btn-primary btn-lg" onclick="signInWithGoogle()">
                    <i class="fab fa-google me-2"></i>Get Started Free
                </button>
            </div>
            <div class="row justify-content-center mb-4">
                <div class="col-md-8">
                    <ul class="list-unstyled text-start">
                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Log cash and card tips in seconds</li>
                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Discover which weekdays earn you the most</li>
                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Stay on top of your goals with quick stats</li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-chart-line me-2"></i>
                                Quick Stats
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="publicQuickStats" class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-calendar-week me-2"></i>
                                Weekday Averages
                            </h5>
                        </div>
                        <div class="card-body">
                            <canvas id="publicWeekdayChart" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center my-5">
                <h2 class="fw-bold mb-3">Ready to take control of your tips?</h2>
                <button class="btn btn-primary btn-lg" onclick="signInWithGoogle()">
                    <i class="fab fa-google me-2"></i>Start Tracking Free
                </button>
            </div>
        </div>

        <!-- Main App Content -->
        <div id="mainApp" class="d-none">
            <!-- Demo Mode Toggle -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <h6 class="card-title mb-0">Data Mode</h6>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="demoModeToggle">
                                    <label class="form-check-label" for="demoModeToggle">
                                        <span id="dataModeLabel">Real Data</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tip Entry Form -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-plus me-2"></i>
                                Add Tip Entry
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="tipForm">
                                <div class="mb-3">
                                    <label for="tipDate" class="form-label">Date</label>
                                    <input type="date" class="form-control" id="tipDate">
                                </div>
                                <div class="mb-3">
                                    <label for="section" class="form-label">Section</label>
                                    <input type="text" class="form-control" id="section" list="sectionsList" placeholder="e.g., cocktail">
                                    <datalist id="sectionsList"></datalist>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="cashTips" class="form-label">Cash Tips ($)</label>
                                        <input type="number" class="form-control" id="cashTips"
                                               step="0.01" min="0" placeholder="0.00">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="cardTips" class="form-label">Card Tips ($)</label>
                                        <input type="number" class="form-control" id="cardTips"
                                               step="0.01" min="0" placeholder="0.00">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="totalSales" class="form-label">Total Sales ($)</label>
                                    <input type="number" class="form-control" id="totalSales" step="0.01" min="0" placeholder="0.00">
                                </div>
                                <div class="mb-3">
                                    <label for="hoursWorked" class="form-label">Hours Worked</label>
                                    <input type="number" class="form-control" id="hoursWorked"
                                           step="0.25" min="0.25" max="24" placeholder="8.0">
                                </div>
                                <div class="mb-3">
                                    <label for="comments" class="form-label">Comments</label>
                                    <textarea class="form-control" id="comments" rows="2" placeholder="Optional notes about your shift"></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary w-100" id="submitTipBtn">
                                    <i class="fas fa-save me-2"></i>
                                    Save Tip Entry
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-chart-line me-2"></i>
                                Quick Stats
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="quickStats" class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Date Filter -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <div class="btn-group" role="group" id="dateFilterBtns">
                                        <input type="radio" class="btn-check" name="dateFilter" id="last7" value="7">
                                        <label class="btn btn-outline-primary" for="last7">Last 7 Days</label>

                                        <input type="radio" class="btn-check" name="dateFilter" id="last30" value="30" checked>
                                        <label class="btn btn-outline-primary" for="last30">Last 30 Days</label>

                                        <input type="radio" class="btn-check" name="dateFilter" id="last90" value="90">
                                        <label class="btn btn-outline-primary" for="last90">Last 90 Days</label>

                                        <input type="radio" class="btn-check" name="dateFilter" id="custom" value="custom">
                                        <label class="btn btn-outline-primary" for="custom">Custom</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div id="customDateRange" class="d-none">
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="date" class="form-control form-control-sm" id="startDate">
                                            </div>
                                            <div class="col-6">
                                                <input type="date" class="form-control form-control-sm" id="endDate">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tip History -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Tip History</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th id="userColumnHeader" class="d-none">User</th>
                                            <th>Section</th>
                                            <th>Sales</th>
                                            <th>Cash</th>
                                            <th>Card</th>
                                            <th>Total</th>
                                            <th>Tip %</th>
                                            <th>Hours</th>
                                            <th>Tips/Hour</th>
                                            <th>Comments</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="tipsTableBody">
                                        <tr>
                                            <td colspan="11" class="text-center text-muted">Loading...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Charts -->
            <div class="row mb-4">
                <!-- Daily Trends -->
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Daily Tips Trend</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="dailyChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Cash vs Card Breakdown -->
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Cash vs Card Tips</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="breakdownChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Weekday Averages -->
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Weekday Averages</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="weekdayChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Tips per Hour -->
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Tips per Hour</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="hourlyChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Tip Percentage -->
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Tip Percentage</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="percentageChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Average Tips by Section -->
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Average Tips by Section</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="sectionChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>

        <!-- Feature Requests / Bug Reports -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-paper-plane me-2"></i>
                            Request Features or Report Bugs
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="mb-3 text-muted">
                            Have an idea or noticed something wrong? Use this form to request new features or report issues you run into while using the app.
                        </p>
                        <form id="requestForm">
                            <div class="mb-3">
                                <label for="requestType" class="form-label">Request Type</label>
                                <select class="form-select" id="requestType">
                                    <option value="feature">Feature Request</option>
                                    <option value="bug">Bug Report</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="requestDetails" class="form-label">Details</label>
                                <textarea class="form-control" id="requestDetails" rows="3" placeholder="Describe your idea or the issue you encountered"></textarea>
                            </div>
                            <button type="submit" class="btn btn-secondary w-100" id="submitRequestBtn">
                                <i class="fas fa-paper-plane me-2"></i>Submit Request
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Custom JS -->
    <!-- <script>
        // Supabase configuration
        const SUPABASE_URL = '{{ config.SUPABASE_URL }}';
        const SUPABASE_ANON_KEY = '{{ config.SUPABASE_ANON_KEY }}';
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    </script> -->
    <script type="module">
      import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'
      window.supabase = createClient(
        'https://okblwnznvxrrubgmrkig.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9rYmx3bnpudnhycnViZ21ya2lnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODMzMzgsImV4cCI6MjA3MDI1OTMzOH0.UZE4OBf9cZG5TYYxBBStlmsiQk03vanmyMoSm4I36XE',
        {
          auth: {
            persistSession: true,
            autoRefreshToken: true,
            detectSessionInUrl: true
          }
        }
      );
    </script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
